{"version":3,"file":"index.js","sources":["../src/FileUploader.tsx"],"sourcesContent":["import * as React from 'react';\nimport { DeleteForever } from \"@material-ui/icons\";\nimport * as PropTypes from \"prop-types\";\nimport {\n    Box,\n    Badge,\n    Typography,\n    Button,\n    List,\n    ListItem,\n    ListItemText,\n    ListItemSecondaryAction,\n    IconButton,\n    CircularProgress\n} from \"@material-ui/core\";\n\n\ninterface FileUploaderProps {\n    borderWidth: number,\n    maxCount: number,\n    minCount: number,\n    title: string,\n    chooseText: \"Choose\",\n    deleteIcon: any,\n    className: any,\n    emptyGuideText: \"Choose file!\",\n    disabled: boolean,\n    showFooter: boolean,\n    onUpload: any,\n};\n\nFileUploader.propTypes = {\n    borderWidth: PropTypes.number,\n    maxCount: PropTypes.number,\n    minCount: PropTypes.number,\n    title: PropTypes.string,\n    chooseText: PropTypes.string,\n    deleteIcon: PropTypes.element,\n    className: PropTypes.any,\n    emptyGuideText: PropTypes.string,\n    disabled: PropTypes.bool,\n    showFooter: PropTypes.bool,\n    onUpload: PropTypes.func\n};\n\nFileUploader.defaultProps = {\n    borderWidth: 1,\n    maxCount: 10,\n    minCount: 0,\n    title: \"Title\",\n    chooseText: \"Choose\",\n    deleteIcon: <DeleteForever />,\n    className: \"\",\n    emptyGuideText: \"List is empty!\",\n    disabled: false,\n    showFooter: false,\n    onUpload: (fileList: Array<File>, afterDone: any) => {\n        console.log(fileList, afterDone);\n    }\n};\n\nfunction FileUploader(props: FileUploaderProps) {\n\n    const refInput = React.useRef<HTMLInputElement>(null);\n\n    const [wait, setWait] = React.useState<boolean>(false);\n    const [message, setMessage] = React.useState<string>(\"\")\n    const [list, setList] = React.useState<Array<File>>([]);\n\n    function deleteItem(item: File) {\n        setList(list.filter(element => element.name !== item.name));\n    }\n\n    function chooseFile() {\n\n        if (refInput !== null && refInput.current !== null) {\n            // console.log(refInput.current);\n            refInput.current.click()\n        }\n\n    }\n\n    function upload() {\n        if (list.length < props.minCount) {\n            setMessage(\"Choose at least \" + list.length.toString() + \" items\");\n        } else {\n            setWait(true);\n            setMessage(\"\");\n            props.onUpload(list, (_message: string) => {\n                setWait(false);\n                setMessage(_message);\n            });\n        }\n    }\n\n    return (\n        <Box border={props.borderWidth} borderColor=\"divider\" className={props.className} >\n            <Box bgcolor=\"background.default\" display=\"flex\" flexDirection=\"row\" p={1} alignItems=\"center\">\n                <Box flexGrow={1}>\n                    <Typography>\n                        {props.title}\n                    </Typography>\n                </Box>\n                <Button size=\"small\" variant=\"text\" onClick={chooseFile} disabled={props.disabled || wait || props.maxCount === list.length}>\n                    {props.chooseText}\n                </Button>\n            </Box>\n            <input\n                ref={refInput}\n                type=\"file\"\n                hidden\n                multiple\n                onChange={(event) => {\n                    console.log((event.target).files);\n                    const files = (event.target).files;\n                    if (files !== null) {\n                        setList([...list, files[0]]);\n                    }\n                }}\n            />\n            <Box overflow=\"auto\" height={150} borderTop={props.borderWidth} borderColor=\"divider\">\n                {list.length === 0 ?\n                    <Box p={1} height=\"100%\" display=\"flex\" alignItems=\"center\" justifyContent=\"center\">\n                        <Typography color=\"textSecondary\" align=\"center\" >\n                            {props.emptyGuideText}\n                        </Typography>\n                    </Box>\n                    :\n                    <List dense>\n                        {\n                            list?.map((file, index) => (\n                                <ListItem key={index} dense>\n                                    <ListItemText primary={file.name} primaryTypographyProps={{ variant: \"caption\", ...wait ? { color: \"textSecondary\" } : { color: \"textPrimary\" } }} />\n                                    <ListItemSecondaryAction >\n                                        <IconButton size=\"small\" onClick={() => deleteItem(file)} disabled={props.disabled || wait}>\n                                            {props.deleteIcon}\n                                        </IconButton>\n                                    </ListItemSecondaryAction>\n                                </ListItem>\n                            ))\n                        }\n                    </List>\n                }\n            </Box>\n            {props.showFooter ?\n                <Box bgcolor=\"background.default\" display=\"flex\" alignItems=\"center\" p={1} borderTop={props.borderWidth} borderColor=\"divider\" >\n                    {\n                        wait ? <CircularProgress size={20} /> : null\n                    }\n                    <Box flexGrow={1}>\n                        <Typography variant=\"caption\">\n                            {message}\n                        </Typography>\n                    </Box>\n                    <Button\n                        size=\"small\"\n                        variant=\"text\"\n                        onClick={upload}\n                        disabled={props.disabled || wait}\n                        endIcon={\n                            <Badge\n                                style={{ marginLeft: 5, marginRight: 5 }}\n                                {...wait ? { color: \"default\" } : { color: \"primary\" }}\n                                badgeContent={list.length} />}>\n                        Upload\n                    </Button>\n                </Box>\n                : null}\n        </Box>\n    );\n}\nexport default FileUploader;"],"names":["PropTypes.number","PropTypes.string","PropTypes.element","PropTypes.any","PropTypes.bool","PropTypes.func","React.createElement","DeleteForever","React.useRef","React.useState","Box","Typography","Button","List","ListItem","ListItemText","ListItemSecondaryAction","IconButton","CircularProgress","Badge"],"mappings":"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"}